
# DELIMITER 语法

`DELIMITER` 用于更改 MySQL 的语句结束符，使得 MySQL 能够正确解析存储过程、函数、触发器等复杂的 SQL 代码。

### 语法

```sql
DELIMITER new_delimiter
```

- `new_delimiter`：新定义的语句结束符，可以是 `//`、`$$` 等任意字符或字符串。
- 结束后通常需要将结束符恢复为分号（`;`）：

```sql
DELIMITER ;
```

### 用法
在定义存储过程、函数或触发器时，需要使用 `DELIMITER` 来避免 MySQL 在遇到分号时错误地认为语句结束。

### 示例

```sql
DELIMITER //
CREATE PROCEDURE ExampleProcedure()
BEGIN
    SELECT 'Hello, World!';
END //
DELIMITER ;
```

# 创建存储过程（CREATE PROCEDURE）

### 语法

```sql
CREATE PROCEDURE procedure_name([IN|OUT|INOUT] param_name data_type, ...)
BEGIN
    -- SQL statements
END
```

- `procedure_name`：存储过程的名称。
- 参数类型：
  - **`IN`**：输入参数，调用者传入的值。
  - **`OUT`**：输出参数，存储过程返回的结果。
  - **`INOUT`**：既可作为输入参数，又可作为输出参数。
- **`BEGIN ... END`**：包含存储过程的主体，包含一个或多个 SQL 语句。

### 示例
创建一个带输入和输出参数的存储过程：

```sql
DELIMITER //
CREATE PROCEDURE AvgCourseScore(IN course_id CHAR(5), OUT avg_score FLOAT)
BEGIN
    SELECT AVG(Grade) INTO avg_score FROM SC WHERE Cno = course_id;
END //
DELIMITER ;
```

# 调用存储过程（CALL）

### 语法

```sql
CALL procedure_name([parameter1, parameter2, ...]);
```

- `procedure_name`：要调用的存储过程的名称。
- 参数：根据存储过程定义传入输入（`IN`）、输出（`OUT`）、或输入输出（`INOUT`）参数。`OUT` 和 `INOUT` 参数需要使用会话变量来存储返回值，如 `@var`。

### 示例
调用不带参数的存储过程：

```sql
CALL ConvertScoreToGrade();
```

调用带输入和输出参数的存储过程：

```sql
CALL AvgCourseScore('YN002', @avg_score);
SELECT @avg_score AS 'Average Score';
```

# MySQL 聚合函数

MySQL 提供了一些用于统计和计算的聚合函数，类似于 `AVG`，主要用于汇总数据。

### 常用聚合函数

- **`AVG(column_name)`**：计算列的平均值。
  
  ```sql
  SELECT AVG(Grade) FROM SC WHERE Cno = 'YN001';
  ```

- **`SUM(column_name)`**：计算列的总和。
  
  ```sql
  SELECT SUM(Grade) FROM SC WHERE Cno = 'YN001';
  ```

- **`COUNT(column_name)`**：统计列中非空值的数量。
  
  ```sql
  SELECT COUNT(Sno) FROM SC WHERE Cno = 'YN001';
  ```

- **`MAX(column_name)`**：返回列的最大值。
  
  ```sql
  SELECT MAX(Grade) FROM SC WHERE Cno = 'YN001';
  ```

- **`MIN(column_name)`**：返回列的最小值。
  
  ```sql
  SELECT MIN(Grade) FROM SC WHERE Cno = 'YN001';
  ```

# 总结

- **`DELIMITER`**：用于临时更改结束符，确保 MySQL 能正确解析存储过程或其他复杂结构。
- **`CREATE PROCEDURE`**：用于定义存储过程，支持输入、输出和双向参数。
- **`CALL`**：用于调用存储过程，可带参数或不带参数。
- **聚合函数**（如 `AVG`, `SUM`, `COUNT`, `MAX`, `MIN`）：用于数据统计和汇总，是 MySQL 中常用的计算工具。


